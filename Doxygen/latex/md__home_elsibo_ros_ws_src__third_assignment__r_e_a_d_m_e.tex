\hypertarget{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md0}{}\doxysection{I\+N\+T\+R\+O\+D\+A\+C\+T\+I\+O\+N\+:}\label{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md0}
\DoxyHorRuler{0}


This is the third and final assignment of Research truck I; In this task we had to create software capable of controlling a mobile robot, creating a multiple choice user interface, which allows the user to choose how to control the robot.

In the user interface with three choices\+:

A) GO TO P\+O\+I\+NT\+: Where the user enters the coordinates of the point where the robot must go.

B) C\+O\+N\+T\+R\+O\+L\+L\+ER\+: Where the user moves the robot with a controller, but the robot can crash with obstacles.

C) A\+S\+S\+I\+S\+T\+E\+NT C\+O\+N\+T\+R\+O\+L\+L\+ER\+: where the user moves the robot with a controller, but the robot does not crash into obstacles, because it is equipped with laserscan which makes it stop near obstacles.

the professor has provided us with packages that simulate the robot in a certain environment delimited by walls; the simulator we used is Gazebo and Rviz.\hypertarget{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md1}{}\doxysection{M\+A\+T\+E\+R\+I\+A\+L A\+N\+D M\+E\+T\+H\+O\+D\+S\+:}\label{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md1}
\DoxyHorRuler{0}


To develop this application we have created two nodes written in C ++, using R\+OS (R\+O\+B\+OT O\+P\+E\+R\+A\+I\+T\+I\+NG S\+Y\+S\+T\+EM); the nodes we have developed are \mbox{\hyperlink{cont__move_8cpp}{cont\+\_\+move.\+cpp}} (control moviment) and \mbox{\hyperlink{navi__goal__rob_8cpp}{navi\+\_\+goal\+\_\+rob.\+cpp}} (navigation and goal for robot). These two nodes communicate with each other and one interfaces with the user, while the other communicates with the robot. The \mbox{\hyperlink{cont__move_8cpp}{cont\+\_\+move.\+cpp}} node communicates through publisher/subscriber with /cmd\+\_\+vel, with node \mbox{\hyperlink{navi__goal__rob_8cpp}{navi\+\_\+goal\+\_\+rob.\+cpp}} and with Laserscan. It receives information from \mbox{\hyperlink{navi__goal__rob_8cpp}{navi\+\_\+goal\+\_\+rob.\+cpp}}, which indicates whether the user wants to increase or decrease the speed of the robot or if he wants to turn left or right, and tells him whether the user wants to activate the assistant controller or not; this communication occurs through the \mbox{\hyperlink{cont__move_8cpp_aa1f1f7f526dc9ee3215fc8f48884bc0a}{vel()}} function. then from the /\+Laserscan it receives the distance of the robot from the obstacles, and if the user had chosen the assistent controller it blocks the speeds in the direction of the obstacles, if instead he had not chosen the assistant controller it continues to give the speeds to the robot, until does not crash into obstacles; then publish the (linear and angular) speeds of the robot to / cmd\+\_\+vel, using the assistcont() function. The navi\+\_\+goal\+\_\+rop.\+cpp node is the node that interfaces with the user and captures his choices (A\+: GO TO P\+O\+I\+NT B\+: C\+O\+N\+T\+R\+O\+L\+L\+ER C\+: A\+S\+S\+I\+S\+T\+E\+NT C\+O\+N\+T\+R\+O\+L\+L\+ER). In the first choice the gopoint() function is called, This function asks the user to enter the coordinates of the point, then checks if these coordinates are inside the perimeter (if not, it asks the user to enter new coordinates) and a the coordinates have been verified), sends \mbox{\hyperlink{cont__move_8cpp}{cont\+\_\+move.\+cpp}} not to publish on /cmd\+\_\+vel, and adjusts the parameters for the goal and sends them to the Move\+Base\+Action server; Then who is the user if he wants to delete the goal; in the positive case it cancels the goal, in the negative case it activates the time out of 25 seconds, and finally we receive the answer whether the robot has reached the goal or not. If the user chooses the assistant controller or the controller The \mbox{\hyperlink{navi__goal__rob_8cpp_a2485f431b3a34c00f60638d555269457}{controller()}} function is called, except that depending on the case the \mbox{\hyperlink{cont__move_8cpp}{cont\+\_\+move.\+cpp}} node, is asked through /vel\+\_\+cont to activate or not the assistant controller. The \mbox{\hyperlink{navi__goal__rob_8cpp_a2485f431b3a34c00f60638d555269457}{controller()}} function collects the data entered by the user for linear and angular velocity, and it sends to \mbox{\hyperlink{cont__move_8cpp}{cont\+\_\+move.\+cpp}} using / vel\+\_\+cont; If you want to stop the robot, enter \textquotesingle{}R\textquotesingle{} (resetting the speeds) or if you want to return to the initial menu, enter \textquotesingle{}A\textquotesingle{}. Finally we created a launch file that starts the simulator, and the cont\+\_\+move node in one terminal and the \mbox{\hyperlink{navi__goal__rob_8cpp}{navi\+\_\+goal\+\_\+rob.\+cpp}} node (graphical interface) in another terminal.

\DoxyHorRuler{0}
 

\DoxyHorRuler{0}
\hypertarget{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md2}{}\doxysubsection{P\+S\+E\+U\+D\+O\+C\+O\+D\+E\+:}\label{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md2}
\hypertarget{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md3}{}\doxysubsection{script cont\+\_\+move.\+cpp rapresent node /contmove\+\_\+rob}\label{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md3}
declaration of global variable; ~\newline
 declared publisher pub1; ~\newline
 defined function \mbox{\hyperlink{cont__move_8cpp_aa1f1f7f526dc9ee3215fc8f48884bc0a}{vel()}}; ~\newline
 taiking data from geometry\+\_\+msgs/\+Point32; ~\newline
 declaration of function assist\+Cont(); ~\newline
 declaration variable of function assist\+Cont(); ~\newline
 making average of data recived from 0 to 260 taked from /\+Laser\+Scan; ~\newline
 making average of data recived from 280 to 440 taked from /\+Laser\+Scan; ~\newline
 making average of data recived from 440 to 720 taked from /\+Laser\+Scan; ~\newline
 chek if assistent control is activate; ~\newline
 (assistcontrol ON)if obstacle is at distance $<$ 0.\+5 robot not go on; ~\newline
 (assistcontrol ON)if obstacle is at distance rigt $<$ 0.\+7 robot not turn Right; ~\newline
 (assistcontrol ON)if obstacle is at distance left $<$ 0.\+7 robot not turn left; ~\newline
 chek if go to poit is active; ~\newline
 (go to point O\+FF) set linear velocity; ~\newline
 (go to point O\+FF) set angular velocity; ~\newline
 (go to point O\+FF) public velocity; ~\newline
 \mbox{\hyperlink{cont__move_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{main()}}; ~\newline
 defined node contmove\+\_\+rob; ~\newline
 defined the node\+Handler; ~\newline
 defined publisher; ~\newline
 loop andless; ~\newline
 defined and calling sb scriber sub2(/vel\+\_\+cont); ~\newline
 defined and calling sb scriber sub2(/scan); ~\newline
 spin; ~\newline
\hypertarget{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md4}{}\doxysubsection{script navi\+\_\+goal\+\_\+rob.\+cpp rapresent node /navi\+\_\+rob}\label{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md4}
declaration of action client Move\+Base\+Action; ~\newline
 declaration of publisher pub; ~\newline
 defined function of \mbox{\hyperlink{navi__goal__rob_8cpp_aca804897307672add9ae8e4bced76834}{go\+Point()}}; ~\newline
 defined the client ac; ~\newline
 sending message; ~\newline
 ac wainting for server; ~\newline
 declaration variable x,y,cont; ~\newline
 sendig message at the user; ~\newline
 taking imput from user; ~\newline
 starting while with cont $<$=0; ~\newline
 cheking if the cordinate is outside of perimeter; ~\newline
 (position outside of perimeter)taking new position from user and ri-\/chek it; ~\newline
 sending to node /contmove\+\_\+rob to stop publication on cmd\+\_\+vel; ~\newline
 defining variable to will set the parameter for client ; ~\newline
 setting parameter for the client; ~\newline
 sending message for information; ~\newline
 sending the goal to the server; ~\newline
 asking to the user if he want to calcel the goal; ~\newline
 (Y\+ES)canceling goal; ~\newline
 (NO)contiuing and starting the timeout for reaching the point(25 second); ~\newline
 given the reponse of wath robot do; ~\newline
 defined the function \mbox{\hyperlink{navi__goal__rob_8cpp_a2485f431b3a34c00f60638d555269457}{controller()}}; ~\newline
 declarationof variabele; ~\newline
 starting of loop endless; ~\newline
 output graphics for user; ~\newline
 taking imput from user; ~\newline
 if imput is \textquotesingle{}e\textquotesingle{} robot increase velocity; ~\newline
 if imput is \textquotesingle{}d\textquotesingle{} robot decrease velocity; ~\newline
 if imput is \textquotesingle{}f\textquotesingle{} robot turn left; ~\newline
 if imput is \textquotesingle{}d\textquotesingle{} robot turn right; ~\newline
 if imput is \textquotesingle{}r\textquotesingle{} stop the robot; ~\newline
 if the imput is \textquotesingle{}a\textquotesingle{}came out from loop; ~\newline
 \mbox{\hyperlink{cont__move_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{main()}}; ~\newline
 defined the node navi\+\_\+goal\+\_\+rob; ~\newline
 defined the node handler nn; ~\newline
 pri t the graphics for user; ~\newline
 taking imput from the user; ~\newline
 if imput is \textquotesingle{}A\textquotesingle{} call the function \mbox{\hyperlink{navi__goal__rob_8cpp_aca804897307672add9ae8e4bced76834}{go\+Point()}}(stop the publication of node /contmove\+\_\+rob); ~\newline
 if imput is \textquotesingle{}B\textquotesingle{} call the function \mbox{\hyperlink{navi__goal__rob_8cpp_a2485f431b3a34c00f60638d555269457}{controller()}}(assistent controller O\+FF); ~\newline
 if imput is \textquotesingle{}C\textquotesingle{} call the function \mbox{\hyperlink{navi__goal__rob_8cpp_a2485f431b3a34c00f60638d555269457}{controller()}}(assistent controller on); ~\newline
 if the imput is \textquotesingle{}s\textquotesingle{} came out from loop;

\DoxyHorRuler{0}
 \hypertarget{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md6}{}\doxysubsection{I\+N\+S\+T\+A\+L\+L\+I\+N\+G A\+N\+D R\+U\+N\+N\+I\+N\+G\+:}\label{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md6}
\DoxyHorRuler{0}


After the installation of R\+OS,(I use a linux(Ubuntu 20.\+04) operator sistem), you shoud be create your work space;


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ mkdir –p/my\_ros\_ws/src}
\DoxyCodeLine{ \$ cd –p/my\_ros\_ws/src}
\end{DoxyCode}


Dowload the folder where there are the node, Cmakelist, pakage and the launch file;


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ git clone https://github.com/ElSibo/Third\_assignment.git}
\DoxyCodeLine{\$ cd ..}
\DoxyCodeLine{\$ catkin\_make}
\DoxyCodeLine{\$ rospack profile}
\DoxyCodeLine{\$ rosclean purge}
\end{DoxyCode}


You must be go inside the folder(the same folder where is present the lunch file), if you want to launch the simulator of mobile robot whit launch file and not manualy. ~\newline
 In the end enter this\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ roslaunch scr/Third\_assignment/navi\_rob.launch}
\end{DoxyCode}


if you use manualy way(in different terminal)\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ roslaunch final\_assignment simulation\_gmapping.launch \&}
\DoxyCodeLine{\$ roslaunch final\_assignment move\_base.launch \&}
\DoxyCodeLine{\$ rosrun navi\_goal\_rob contmove\_rob \&}
\end{DoxyCode}


indifferent terminal\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$  rosrun navi\_goal\_rob navi\_goal\_rob }
\end{DoxyCode}
\hypertarget{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md7}{}\doxysubsection{I am attaching the link to see the video of the simulation}\label{md__home_elsibo_ros_ws_src__third_assignment__r_e_a_d_m_e_autotoc_md7}
\href{https://youtu.be/IAk0OnLwEMk}{\texttt{ https\+://youtu.\+be/\+I\+Ak0\+On\+Lw\+E\+Mk}}

Now you can see the the concetual map for the assignment\+:

\DoxyHorRuler{0}
 

\DoxyHorRuler{0}
 